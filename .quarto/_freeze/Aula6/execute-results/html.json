{
  "hash": "7572aedb76e50b476dab56fa022f0683",
  "result": {
    "markdown": "---\ntitle: \"Anova com um fator\"\n---\n\n\n## Três tratamentos ou mais\n\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-1_24aceb32d79a8ce85d231e58d008c607'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-2_eaf25193c2fab425c6a278852ee3ecaa'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nmicelial |>\n  ggplot(aes(especie, tcm))+\n  geom_jitter()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nA função anova() permite a observação da variabilidade em cada grupo.\n\nO bartlett.test() é um teste estatístico utilizado para verificar se múltiplas amostras independentes possuem variâncias homogêneas.\n\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-3_c9ee2a640f0deee5510e834a28f607a5'}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~ especie -1, data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nespecie    5 51.677 10.3354   552.2 < 2.2e-16 ***\nResiduals 25  0.468  0.0187                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie - 1, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \nespecieFasi  1.57167    0.05585   28.14  < 2e-16 ***\nespecieFaus  1.23667    0.05585   22.14  < 2e-16 ***\nespecieFcor  1.32167    0.05585   23.66  < 2e-16 ***\nespecieFgra  0.91167    0.05585   16.32 7.66e-15 ***\nespecieFmer  1.42667    0.05585   25.54  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.991,\tAdjusted R-squared:  0.9892 \nF-statistic: 552.2 on 5 and 25 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(tcm ~especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nmedias1 <- emmeans(m1, ~ especie)\n\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n\n```{.r .cell-code}\ncheck_model(m1)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\nUsa-se a função count() para fazer a contagem do número de repetições (n), contagem dos insetos mortos devido a condição inseticida. Os dados apresentam apenas um fator, portanto faz-se uma anova unifatorial.\n\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-4_cc51815f276dda7c797d01846bcd535f'}\n\n```{.r .cell-code}\nlibrary (ggplot2)\n\ntheme_set(theme_bw())\n\ninseticida <- InsectSprays\nlibrary(tidyverse)\ninseticida |>\n  count(spray)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  spray  n\n1     A 12\n2     B 12\n3     C 12\n4     D 12\n5     E 12\n6     F 12\n```\n:::\n:::\n\n\n## Visualização dos dados\n\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-5_55fd3d1ad01ff6f8489ed8c0cd755311'}\n\n```{.r .cell-code}\ninseticida |>\n  ggplot(aes(spray, count))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nPode-se observar pelo gráfico boxplot gerado, que o eixo y mostra a contagem do número de insetos mortos, que há variabilidade, o spray F apresenta maior variância entre o grupo e o spray E menor variância. Também, pode-se observar outliers nos grupos C e D.\n\n\n::: {.cell hash='Aula6_cache/html/unnamed-chunk-6_1f6ab2527f205e8d53e564378afcad20'}\n\n```{.r .cell-code}\nm1 <- lm(count~spray,\n         data = inseticida)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = count ~ spray, data = inseticida)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.333 -1.958 -0.500  1.667  9.333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  14.5000     1.1322  12.807  < 2e-16 ***\nsprayB        0.8333     1.6011   0.520    0.604    \nsprayC      -12.4167     1.6011  -7.755 7.27e-11 ***\nsprayD       -9.5833     1.6011  -5.985 9.82e-08 ***\nsprayE      -11.0000     1.6011  -6.870 2.75e-09 ***\nsprayF        2.1667     1.6011   1.353    0.181    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.922 on 66 degrees of freedom\nMultiple R-squared:  0.7244,\tAdjusted R-squared:  0.7036 \nF-statistic:  34.7 on 5 and 66 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: count\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nspray      5 2668.8  533.77  34.702 < 2.2e-16 ***\nResiduals 66 1015.2   15.38                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nm1_medias <- emmeans(m1, ~ spray)\nplot(m1_medias)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(m1_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n spray emmean   SE df lower.CL upper.CL .group\n C       2.08 1.13 66   -0.177     4.34  1    \n E       3.50 1.13 66    1.240     5.76  1    \n D       4.92 1.13 66    2.656     7.18  1    \n A      14.50 1.13 66   12.240    16.76   2   \n B      15.33 1.13 66   13.073    17.59   2   \n F      16.67 1.13 66   14.406    18.93   2   \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n\n```{.r .cell-code}\npwpm(m1_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        A       B       C       D       E       F\nA [14.50]  0.9952  <.0001  <.0001  <.0001  0.7542\nB  -0.833 [15.33]  <.0001  <.0001  <.0001  0.9603\nC  12.417  13.250 [ 2.08]  0.4921  0.9489  <.0001\nD   9.583  10.417  -2.833 [ 4.92]  0.9489  <.0001\nE  11.000  11.833  -1.417   1.417 [ 3.50]  <.0001\nF  -2.167  -1.333 -14.583 -11.750 -13.167 [16.67]\n\nRow and column labels: spray\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\npwpp(m1_medias)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\npairs(m1_medias)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n contrast estimate  SE df t.ratio p.value\n A - B      -0.833 1.6 66  -0.520  0.9952\n A - C      12.417 1.6 66   7.755  <.0001\n A - D       9.583 1.6 66   5.985  <.0001\n A - E      11.000 1.6 66   6.870  <.0001\n A - F      -2.167 1.6 66  -1.353  0.7542\n B - C      13.250 1.6 66   8.276  <.0001\n B - D      10.417 1.6 66   6.506  <.0001\n B - E      11.833 1.6 66   7.391  <.0001\n B - F      -1.333 1.6 66  -0.833  0.9603\n C - D      -2.833 1.6 66  -1.770  0.4921\n C - E      -1.417 1.6 66  -0.885  0.9489\n C - F     -14.583 1.6 66  -9.108  <.0001\n D - E       1.417 1.6 66   0.885  0.9489\n D - F     -11.750 1.6 66  -7.339  <.0001\n E - F     -13.167 1.6 66  -8.223  <.0001\n\nP value adjustment: tukey method for comparing a family of 6 estimates \n```\n:::\n\n```{.r .cell-code}\nm1$residuals\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          1           2           3           4           5           6 \n-4.50000000 -7.50000000  5.50000000 -0.50000000 -0.50000000 -2.50000000 \n          7           8           9          10          11          12 \n-4.50000000  8.50000000  2.50000000  5.50000000 -0.50000000 -1.50000000 \n         13          14          15          16          17          18 \n-4.33333333  1.66666667  5.66666667 -4.33333333  0.66666667 -1.33333333 \n         19          20          21          22          23          24 \n 1.66666667  1.66666667  3.66666667  5.66666667 -8.33333333 -2.33333333 \n         25          26          27          28          29          30 \n-2.08333333 -1.08333333  4.91666667 -0.08333333  0.91666667 -1.08333333 \n         31          32          33          34          35          36 \n-0.08333333 -1.08333333  0.91666667 -2.08333333 -1.08333333  1.91666667 \n         37          38          39          40          41          42 \n-1.91666667  0.08333333  7.08333333  1.08333333 -0.91666667 -1.91666667 \n         43          44          45          46          47          48 \n 0.08333333  0.08333333  0.08333333  0.08333333 -2.91666667 -0.91666667 \n         49          50          51          52          53          54 \n-0.50000000  1.50000000 -0.50000000  1.50000000 -0.50000000  2.50000000 \n         55          56          57          58          59          60 \n-2.50000000 -2.50000000 -0.50000000 -1.50000000  2.50000000  0.50000000 \n         61          62          63          64          65          66 \n-5.66666667 -7.66666667 -1.66666667  5.33333333 -1.66666667 -0.66666667 \n         67          68          69          70          71          72 \n-3.66666667 -6.66666667  9.33333333  9.33333333  7.33333333 -3.66666667 \n```\n:::\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(m1$residuals)\nqqline(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.96006, p-value = 0.02226\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(count ~spray,\n              data = inseticida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  count by spray\nBartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Non-normality of residuals detected (p = 0.022).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n:::\n\n\nA função lm() que significa linear model, é usado para modelar dados em uma relação linear entre a variavel dependente (resposta) e independente (tratamento).\n\n\"\\~\" significa em função de.\n\nA função summary ajuda na visualização dos dados. Observar previamente o erro-padrão, graus de liberdade, estatistica de T, e valor P. A comparação foi em relação ao tratamento A.\n\nA função anova() apresenta o valor de F que é o teste de análise de variância, vai determinar a variabilidade entre os grupos (se o valor calculado for maior que o tabelado, rejeita-se a hipótese nula de que as médias são iguais(P\\<0,05)).\n\nA função emmeans() pode ser utilizada para vizualizar as médias e comparar este valor em cada tratamento. Dentro do pacote multicomp, há a função cld que permite visualizar os tratamentos agrupados de acordo com um teste estatistico (Tukey) no exemplo há 2 grupos formados (C, E e D) e (A, B e F), portanto há diferença entre os tratamentos, como pode-se observar na Anova.\n\nA função pwpm() mostra a comparação entre as médias dos tratamentos pelo teste de tukey. Triângulo superior mostra o p-valor. A diagonal mostra a média e o triângulo inferior mostra a diferença dos tratamentos em relação a média. A função pairs() também pode ser usada para a visualização dos valores de T e p- valor.\n\nA função pwpp() mostra a visualização do teste de Tukey em relação aos tratamentos.\n\nO valor dos resíduos (erro) pode ser visualizado utilizando \\$ (seleciona uma coluna no conjunto de dados). No exemplo, m1 é o conjunto e residuals é o que se deseja selecionar. Pode-se utilizar a função hist() para visualização a distribuiçõao dos residuos e ver se a mesma se aproxima da distribuição normal.\n\nAs funções qqnorm(m1\\$residuals) e qqline() juntas mostram um gráfico com os valores da distribuição dos resíduos em circulos e a reta dos residuos esperados. Essas funções plotam os resíduos simulados do modelo, o que pode ser útil para avaliar a adequação do modelo aos dados.\n\nA função shapiro.test mostra se a distribuição dos dados é normal (Se o valor estiver abaixo de 0,05 a distribuição não é considerada normal). A função check_normality() também pode ser usada para ver a normalidade dos dados.\n\nA função bartlett.test() mostra se as variâncias são ou não homogêneas (valor abaixo de 0,05 não é considerado homogênea). A função check_heteroscedasticity() também mostra a homogeneidade das variâncias.\n\nComo a distribuição do conjunto dos dados não foram normais e as variâncias não foram homogêneas, pode se utilizar alternativas para corrigir a distribuição e homogeneidade dos dados -> Transformação.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}