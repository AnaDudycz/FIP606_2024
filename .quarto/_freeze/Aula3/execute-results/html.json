{
  "hash": "aa89066dbfa3d840f4ccffd3244f05eb",
  "result": {
    "markdown": "---\ntitle: \"Gráficos com ggplot\"\n---\n\n\n## Constução de gráficos\n\nCom o pacote **ggplot2** e a função **ggplot**é possivel criar gráficos a partir da planilha carregada anteriormente. Com este pacote é possível escolher o tipo de gráfico como o geom_boxplot no exemplo abaixo e personalizar da maneira desejada, com comandos e argumentos necessários, pode-se ajusta a cor, distâncias e tamanho das linhas e barras, adicionar legenda e formatar os eixos. Para salvar o gráfico gerado a função **ggsave** pode ser utilizada.\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-1_8fd277f198ce36dd05ee80c1f1e78ee0'}\n\n```{.r .cell-code}\nlibrary(gsheet)\ndf4 <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nlibrary(ggplot2)\nlibrary(ggthemes)\ng1 <- df4 |> \n  ggplot(aes(x = trat, y = comp)) +\n  geom_boxplot(outlier.colour = NA,\n               fill = \"green\")+\n  geom_jitter(width = 0.05,\n              color = 'black',\n              shape = 2,\n              size = 3)+\n  theme_clean()+\n  labs (x = \"tratamento\",\n       y = \"comprimento (mm)\",\n       title = \"Meu primeiro ggplot\",\n       caption = \"Fonte: Dados diversos\")\ng1\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ylim(0,20)+\n  scale_y_continuous(limits = c(5,20),\n                     n.breaks =10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<ScaleContinuousPosition>\n Range:  \n Limits:    5 --   20\n```\n:::\n\n```{.r .cell-code}\n  ggsave(\"plot1.png\", bg = \"white\")\n```\n:::\n\n\n## Importando os dados com o pacote tidyverse\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-2_4f51dca1a07831fed85c52f1483b2f71'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\nglimpse(cr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 405\nColumns: 13\n$ farm            <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ region          <chr> \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", \"SNNPR\", …\n$ zone            <chr> \"Bench Maji\", \"Bench Maji\", \"Bench Maji\", \"Bench Maji\"…\n$ district        <chr> \"Debub Bench\", \"Debub Bench\", \"Debub Bench\", \"Debub Be…\n$ lon             <dbl> 35.44250, 35.44250, 35.42861, 35.42861, 35.42861, 35.3…\n$ lat             <dbl> 6.904722, 6.904722, 6.904444, 6.904444, 6.904444, 6.90…\n$ altitude        <dbl> 1100, 1342, 1434, 1100, 1400, 1342, 1432, 1100, 1400, …\n$ cultivar        <chr> \"Local\", \"Mixture\", \"Mixture\", \"Local\", \"Local\", \"Mixt…\n$ shade           <chr> \"Sun\", \"Mid shade\", \"Mid shade\", \"Sun\", \"Sun\", \"Mid sh…\n$ cropping_system <chr> \"Plantation\", \"Plantation\", \"Plantation\", \"Plantation\"…\n$ farm_management <chr> \"Unmanaged\", \"Minimal\", \"Minimal\", \"Unmanaged\", \"Unman…\n$ inc             <dbl> 86.70805, 51.34354, 43.20000, 76.70805, 47.15808, 51.3…\n$ sev2            <dbl> 55.57986, 17.90349, 8.25120, 46.10154, 12.25167, 19.91…\n```\n:::\n:::\n\n\n## Trabalhando os dados\n\nPara visualizar os dados do conjunto chamado **cr**, os dados foram agrupados com a função group_by(), posteriormente Calculada a média com o comando mean(), os resultados visualizados com ggplot.\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-3_885c90547ff9cf6530e96f6e6aa52fa0'}\n\n```{.r .cell-code}\nsummary(cr$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   9.50   19.43   32.50   34.89   48.20   86.71 \n```\n:::\n\n```{.r .cell-code}\ncr |>\n  group_by(cultivar) |>\n    summarize(inc_mean = mean(inc),\nsd_mean = sd(inc))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  cultivar inc_mean sd_mean\n  <chr>       <dbl>   <dbl>\n1 Improved     16.4    5.66\n2 Local        53.4   14.3 \n3 Mixture      31.9   11.2 \n```\n:::\n\n```{.r .cell-code}\ncr |>\n  ggplot(aes(x=inc))+\n  geom_histogram()+\n  facet_grid(region~cultivar)\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Usando as funções para sumarizar\n\nA função summarize () é utilizada para criar novas variáveis a partir do conjunto de dados já agrupados.\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-4_acf907c193edaaded107e7f58611611a'}\n\n```{.r .cell-code}\ncr |>\n group_by(region) |>\n    summarize(sev_med = median(sev2),\n              sev_mean = mean(sev2),\n              sev_sd = sd(sev2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 4\n  region sev_med sev_mean sev_sd\n  <chr>    <dbl>    <dbl>  <dbl>\n1 Oromia    6.23     8.06   6.82\n2 SNNPR     4.88     9.81  10.5 \n```\n:::\n\n```{.r .cell-code}\ncr |>\n  ggplot(aes(inc,sev2))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Visualizando os dados\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-5_94e2368a0836ace00556ee430fb2d36a'}\n\n```{.r .cell-code}\nlibrary(ggthemes)\ncr |>\n  ggplot(aes(x =sev2, fill = region))+\n  geom_histogram(color = \"white\")+\n  facet_wrap(region ~ cultivar, ncol = 6)+\n  scale_fill_manual(values = c(\"black\", \"brown\"))+\n  theme_minimal(base_size = 14)+\n  theme(legend.position = \"bottom\")+\n  labs(y = \"Frequency\",\n       x = \"Severity (%)\", fill= \"Region\")\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#ggsave(\"crl.png\", bg = \"white\")\n```\n:::\n\n\n## Criando subconjuntos \n\nO pacote **dplyr** possui funções que ajudam na manipulação dos dados e facilitam a visualização, como a função select() que seleciona as coluna de um dataframe e a função filter() que permite-se fazer a filtragem das linhas do conjunto.\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-6_35357bf518771eca1a1293f6b2506da7'}\n\n```{.r .cell-code}\n# filtra Oromia\ncr_oromia <- cr |>\n  select(farm, region, cultivar, sev2) |>\n  filter(region == \"Oromia\")\n\n# filtra SNNPR\ncr_pr <- cr|>\n  select(farm, region, cultivar, sev2) |>\n  filter(region == \"SNNPR\")\n\ncr_pr\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 240 × 4\n    farm region cultivar  sev2\n   <dbl> <chr>  <chr>    <dbl>\n 1     1 SNNPR  Local    55.6 \n 2     2 SNNPR  Mixture  17.9 \n 3     3 SNNPR  Mixture   8.25\n 4     4 SNNPR  Local    46.1 \n 5     5 SNNPR  Local    12.3 \n 6     6 SNNPR  Mixture  19.9 \n 7     7 SNNPR  Mixture  11.9 \n 8     8 SNNPR  Local    55.6 \n 9     9 SNNPR  Local    11.6 \n10    10 SNNPR  Mixture  11.4 \n# ℹ 230 more rows\n```\n:::\n:::\n\n\n## Visualizando os subconjuntos\n\n\n::: {.cell hash='Aula3_cache/html/unnamed-chunk-7_29d500b183e288dacaecb11cde25a1a5'}\n\n```{.r .cell-code}\np1 <- cr_oromia |>\n  ggplot(aes(cultivar, sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+\n  scale_fill_few()+\n  labs(x = \"\",\n       y = \"Severity (%)\")+\n    coord_flip()\n\np2 <- cr_pr |>\n  ggplot(aes(cultivar, sev2,\n             fill = cultivar))+\n  geom_boxplot()+\n  theme_few()+\n  scale_fill_few()+\n  labs(x = \"\",\n       y = \"Severity (%)\")+\n    coord_flip()\n\np1\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\np2\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n\np1 + p2 +\n  plot_layout(guides = 'collect',\n  axes = 'collect')+\n  plot_annotation(title = \"Coffe rust in Ethiopia\",\n                  caption = \"Source: Dudycz (2024)\")\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\n  plot_annotation(tag_levels = 'A')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$title\nNULL\n\n$subtitle\nNULL\n\n$caption\nNULL\n\n$tag_levels\n[1] \"A\"\n\n$tag_prefix\nNULL\n\n$tag_suffix\nNULL\n\n$tag_sep\nNULL\n\n$theme\n Named list()\n - attr(*, \"class\")= chr [1:2] \"theme\" \"gg\"\n - attr(*, \"complete\")= logi FALSE\n - attr(*, \"validate\")= logi TRUE\n\nattr(,\"class\")\n[1] \"plot_annotation\"\n```\n:::\n\n```{.r .cell-code}\nggsave(\"patch1.png\", width = 6,\n       height = 4)\n\np3 <- cr_oromia |>\n  ggplot(aes(x = sev2))+\n  geom_histogram()\n\np1 + inset_element(p3, left = 0.6, bottom = 0.6, right = 1, top = 1)\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n\n```{.r .cell-code}\np1/ (p2 + p1)\n```\n\n::: {.cell-output-display}\n![](Aula3_files/figure-html/unnamed-chunk-7-5.png){width=672}\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}