{
  "hash": "abc5677dd0d71bf49ef3452ffef183c0",
  "result": {
    "markdown": "---\ntitle: \"ANOVA com parcela subdividida\"\n---\n\n\nA ANOVA para parcelas subdivididas é uma técnica estatística usada em experimentos onde existem duas ou mais fontes de variabilidade que estão hierarquicamente estruturadas. Pode-se ter diferentes tratamentos aplicados a parcelas principais e subparcelas dentro dessas parcelas principais recebendo diferentes tratamentos adicionais.\n\n## Carregando os dados\n\n\n::: {.cell hash='Aula10_cache/html/unnamed-chunk-1_8e9f95c6ddf401105287de543d509edc'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nmilho <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1345524759\")\n```\n:::\n\n\n## Visualização da variável Index\n\n\n::: {.cell hash='Aula10_cache/html/unnamed-chunk-2_006dda48658112d48ea69f1081b719e9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary (ggplot2)\n\nmilho |>\n  ggplot(aes(method, index))+\n  geom_jitter(width=0.1, alpha = 0.2)+\n  facet_wrap(~hybrid)+\n  stat_summary(fun.data = \n                 \"mean_cl_boot\", size=0.5, color=\n                 \"blue\")\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Anova para parcela subdividida\n\n\n::: {.cell hash='Aula10_cache/html/unnamed-chunk-3_4d16c7c37a329aaf3ca67135839c2ac3'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lme4)\nlibrary(car)\n\nmilho <- milho |>\n  mutate(block = as.factor(block))\n\nmix2 <- lmer(sqrt(index) ~ hybrid*method + block +\n               (1|block/hybrid), data = milho)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nhybrid        15.3159  5   0.009095 **\nmethod         3.8886  1   0.048615 * \nblock          0.0718  3   0.994997   \nhybrid:method 13.3812  5   0.020057 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.440).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.971).\n```\n:::\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nqqnorm(residuals(mix2))\nqqline(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals(mix2))\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nmedias_milho <- emmeans(mix2,\n                        ~hybrid | method,\n                        type = \"response\")\nmedias_milho2 <- emmeans(mix2,\n                        ~method | hybrid,\n                         type = \"response\")\n\nlibrary (multcomp)\ncld(medias_milho, Letters = LETTERS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmethod = pin:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.4 10.7 6084     4.10     46.0  A    \n 30K64        20.3 10.9 6084     4.51     47.4  A    \n 30F53 YH     24.5 12.0 6084     6.61     53.7  AB   \n 30F53 HX     25.0 12.1 6084     6.84     54.4  AB   \n 30S31YH      31.7 13.7 6084    10.57     64.2  AB   \n 30S31H       37.1 14.8 6084    13.79     71.8   B   \n\nmethod = silk:\n hybrid   response   SE   df lower.CL upper.CL .group\n BG7049H      19.1 10.6 6084     3.96     45.6  A    \n 30K64        21.3 11.2 6084     5.00     48.9  A    \n 30F53 HX     24.4 12.0 6084     6.56     53.6  A    \n 30F53 YH     26.0 12.4 6084     7.42     56.0  A    \n 30S31H       26.3 12.5 6084     7.57     56.4  A    \n 30S31YH      26.4 12.5 6084     7.62     56.5  A    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \nNote: contrasts are still on the sqrt scale \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n\nDe acordo com o quado da anova pode-se observar que há interação entre hibrido e o método utilizado, ou seja, de acordo com essa interação o valor de index muda. Caso nao desse significativo poderia-se analisar o p-valor em isolado (tratamneto, bloco, etc.)\n\nTambém pode-se observar que teve diferença entre o método Pin e Silk no hibrido 4, o método teve efeito. Houve variabilidade (a observação pode ser feita em cada método). Obs.: letras maiusculas comparam na coluna, minuscula na linha (% de significancia pelo teste de tukey).\n\n\n::: {.cell hash='Aula10_cache/html/unnamed-chunk-4_7401516ad160b54a711945bb80d65950'}\n\n```{.r .cell-code}\nmix3 <- lmer(sqrt(yield) ~ hybrid*method + block +\n               (1|block/hybrid), data = milho)\nAnova(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(yield)\n                Chisq Df Pr(>Chisq)    \nhybrid        25.5591  5  0.0001086 ***\nmethod         0.0520  1  0.8196750    \nblock          2.3606  3  0.5010021    \nhybrid:method 24.4985  5  0.0001741 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\ncheck_normality(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.214).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.686).\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}