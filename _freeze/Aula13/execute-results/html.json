{
  "hash": "ff91504a9f448cb7dcd1c4f121755ece",
  "result": {
    "markdown": "---\ntitle: \"Regressão não-linear\"\nformat: html\neditor: visual\n---\n\n\nA regressão não-linear é usada quando a relação entre as variáveis independentes e dependentes não pode ser modelada por uma função linear.\n\nO pacote drc permite ajustar modelos de regressão dose-resposta e realizar análises estatísticas, ou seja, permite ajustar curvas de dose-resposta dos dados. Esse pacote também fornece funções para calcular estimativas de EC50 (qual valor de X reduziu em 50% o valor de Y).\n\nOutro pacote que permite calcular o valor de EC50 é o ec50estimator.\n\n\n::: {.cell hash='Aula13_cache/html/unnamed-chunk-1_5aa02c32178bb60c10d1ba81761ab7a5'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(ggplot2)\nlibrary(tidyverse)\n\npyra <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n\npyra2 <- pyra |> \n  group_by(code, state, dose) |> \n  summarise(mean_germination = mean(germination)) \n\npyra2|> \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  facet_wrap(~code)\n```\n\n::: {.cell-output-display}\n![](Aula13_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(drc)\n\nisolado165 <- pyra2 |> \n  filter(code == \"186\")\n\ndrc1 <- drm(mean_germination ~ dose, data = isolado165,\n            fct = W1.3())\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 20.97861\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula13_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.612064   0.015429 0.562963 0.661165\n```\n:::\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Weibull (type 1) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value   p-value    \nb:(Intercept)  2.832159   0.213496  13.266 0.0009257 ***\nd:(Intercept) 48.767893   0.716131  68.099 6.978e-06 ***\ne:(Intercept)  0.696626   0.018156  38.368 3.895e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.009228 (3 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nlibrary(ec50estimator)\ndf_ec50 <- estimate_EC50(mean_germination ~ dose,\n                         data = pyra2,\n                         isolate_col = \"code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\n\ndf_ec50 |> \n  ggplot(aes(reorder(ID, Estimate), Estimate))+\n  geom_point()+\n  geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1)+\n  coord_flip()        \n```\n\n::: {.cell-output-display}\n![](Aula13_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}